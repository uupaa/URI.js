var d=this.self||global;function j(){return d.location?d.location.href||"":""}function l(a){var b=m.exec(a);return b?n({href:a,protocol:b[1],pathname:b[2],search:b[3],fragment:b[4]}):(b=p.exec(a))?n({href:a,protocol:b[1],secure:"https:"===b[1]||"wss:"===b[1],host:b[2],auth:b[3],hostname:b[4],port:b[5]?+b[5]:q[b[1]]||0,pathname:b[6],search:b[7],fragment:b[8]}):(b=r.exec(a))?n({href:a,pathname:b[1],search:b[2],fragment:b[3]}):n({href:a,pathname:a,error:!0})}
function n(a){var b=a.pathname.split("/");a.href=a.href||"";a.protocol=a.protocol||"";a.scheme=a.protocol;a.secure=a.secure||!1;a.host=a.host||"";a.auth=a.auth||"";a.hostname=a.hostname||"";a.port=a.port||0;a.pathname=a.pathname||"";a.file=b.pop();a.dir=b.join("/");a.search=a.search||"";a.query=s(a.search);a.fragment=a.fragment||"";a.error=a.error||!1;return a}
function t(a){var b="file:"===a.protocol?"///":"//";return[a.protocol,a.protocol?b:"",a.host||"",a.pathname||"/",a.search||"",a.fragment||""].join("")}function u(a){return/^(https?|wss?):/.test(a)?p.test(a):m.test(a)}function s(a){var b={};0<=a.indexOf("?")&&(a=a.split("?")[1].split("#")[0]);a.replace(/&amp;|&|;/g,";").replace(/(?:([^\=]+)\=([^\;]+);?)/g,function(a,e,g){a=j.encode(e);g=j.encode(g);b[a]?Array.isArray(b[a])?b[a].push(g):b[a]=[b[a],g]:b[a]=g;return""});return b}
function v(a){function b(a){return 16>a?"0"+a.toString(16):a.toString(16)}for(var f=[],e=0,g=a.length,c=0,h;e<g;++e)c=a.charCodeAt(e),128>c?((h=95===c||48<=c&&57>=c||65<=c&&90>=c||97<=c&&122>=c)||(h=33===c||45===c||46===c||126===c||39<=c&&42>=c),h?f.push(a.charAt(e)):f.push("%",b(c))):2048>c?f.push("%",b(c>>>6&31|192),"%",b(c&63|128)):65536>c&&f.push("%",b(c>>>12&15|224),"%",b(c>>>6&63|128),"%",b(c&63|128));return f.join("")}
function w(a){return a.replace(/(%[\da-f][\da-f])+/g,function(a){var f=[];a=a.split("%").slice(1);for(var e=0,g=a.length,c=0,h=0,k=0;e<g;++e){c=parseInt(a[e],16);if(c!==c)throw Error("invalid URI.decode");128>c?f.push(c):224>c?(h=parseInt(a[++e],16),f.push((c&31)<<6|h&63)):240>c&&(h=parseInt(a[++e],16),k=parseInt(a[++e],16),f.push((c&15)<<12|(h&63)<<6|k&63))}return String.fromCharCode.apply(null,f)})}
var x="process"in d,q={"http:":80,https:443,"ws:":81,"wss:":816},p=/^(\w+:)\/\/((?:([\w:]+)@)?([^\/:]+)(?::(\d*))?)([^ :?#]*)(?:(\?[^#]*))?(?:(#.*))?$/,m=/^(file:)\/{2,3}(?:localhost)?([^ ?#]*)(?:(\?[^#]*))?(?:(#.*))?$/i,r=/^([^ ?#]*)(?:(\?[^#]*))?(?:(#.*))?$/;j.name="URI";j.repository="https://github.com/uupaa/URI.js";j.parse=l;j.build=t;
j.resolve=function(a){if(u(a))return a;if("document"in d){var b=d.document.createElement("a");b.setAttribute("href",a);return b.cloneNode(!1).href}throw Error("URI.resolve will not work");};j.normalize=function(a){a=l(a);var b=a.dir.split("/").reduce(function(a,b){".."===b?a.pop():/^\.+$/.test(b)||a.push(b);return a},[]).join("/");a.pathname=("/"+b+"/").replace(/\/+/g,"/")+a.file;return t(a)};j.isAbsolute=u;j.isRelative=function(a){return p.test("http://a.a/"+a.replace(/^\/+/,""))};
j.buildQuery=function(a,b){b=b||"&";var f=[],e;for(e in a){var g=j.encode(e),c=a[e];Array.isArray(c)||(c=[c]);for(var h=[],k=0,y=c.length;k<y;++k)h.push(g+"="+j.encode(c[k]));f.push(h.join(b))}return f.join(b)};j.parseQuery=s;j.encode=d.encodeURIComponent||v;j.decode=d.decodeURIComponent||w;x&&(module.exports=j);d.URI?d.URI_=j:d.URI=j;
